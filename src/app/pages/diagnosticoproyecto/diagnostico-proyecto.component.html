<div class="min-h-screen bg-gradient-construction">
  <div class="text-center py-8">
    <h1 class="text-4xl font-bold text-gray-700 mb-2">Diagnóstico del Proyecto</h1>
    <div class="my-16">
      <p class="text-gray-600 mb-2">A través de este formulario lograremos asesorarte mejor:</p>
      <div class="w-1/3 mx-auto h-1 bg-gray-300 rounded-full overflow-hidden">
        <div class="h-full bg-lime-green" [style.width]="progressBarWidth"></div>
      </div>
    </div>
  </div>
  <div class="flex items-center justify-center min-h-screen -mt-72">
    <div class="relative z-10 p-10 bg-white shadow-lg rounded-3xl border border-gray-300 max-w-3xl w-full">
      <form [formGroup]="form" (ngSubmit)="onContinue()">
        <!-- Question 1: Name -->
        <ng-container *ngIf="currentQuestion === 1">
          <div class="mb-4">
            <label for="name" class="block text-gray-700 text-sm font-bold mb-2">
              1 → Nombre Cliente
            </label>
            <input id="name" formControlName="name" name="name" type="text" placeholder="Your name" autocomplete="name"
                   class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
            <div *ngIf="name?.invalid && (name?.dirty || name?.touched)" class="text-red-500 text-sm mt-2">
              <div *ngIf="name?.errors?.['required']">
                Nombre Cliente es requerido.
              </div>
              <div *ngIf="name?.errors?.['pattern']">
                Solo permite letras A-Z.
              </div>
            </div>
          </div>
        </ng-container>
        
        <!-- Question 2: Project Type -->
        <ng-container *ngIf="currentQuestion === 2">
          <div class="mb-4">
            <label for="projectType" class="block text-gray-700 text-sm font-bold mb-2">
              2 → Seleccione un tipo de proyecto
            </label>
            <div class="relative">
              <select id="projectType" formControlName="projectType" name="projectType" autocomplete="off" class="block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 pr-8 rounded shadow leading-tight focus:outline-none focus:shadow-outline">
                <option value="">Seleccione un tipo de proyecto</option>
                <option *ngFor="let proyecto of proyectos" [value]="proyecto">{{ proyecto }}</option>
              </select>
              <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                  <path d="M7 10l5 5 5-5H7z" />
                </svg>
              </div>
              <div *ngIf="projectType?.invalid && (projectType?.dirty || projectType?.touched)" class="text-red-500 text-sm mt-2">
                <div *ngIf="projectType?.errors?.['required']">
                  Debes seleccionar tipo proyecto.
                </div>
              </div>
            </div>
          </div>
        </ng-container>

        <!-- Question 3: Floor -->
        <ng-container *ngIf="currentQuestion === 3">
          <div class="mb-4">
            <label for="floor" class="block text-gray-700 text-sm font-bold mb-2">
              4 → Piso
            </label>
            <div class="relative">
              <select id="floor" formControlName="floor" name="floor" autocomplete="off" class="block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 pr-8 rounded shadow leading-tight focus:outline-none focus:shadow-outline">
                <option value="">Seleccione un piso</option>
                <option *ngFor="let piso of pisos" [value]="piso">{{ piso }}</option>
              </select>
              <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                  <path d="M7 10l5 5 5-5H7z" />
                </svg>
              </div>
              <div *ngIf="floor?.invalid && (floor?.dirty || floor?.touched)" class="text-red-500 text-sm mt-2">
                <div *ngIf="floor?.errors?.['required']">
                  Debes seleccionar Piso.
                </div>
              </div>
            </div>
          </div>
        </ng-container>

        <!-- Question 4: Country -->
        <ng-container *ngIf="currentQuestion === 4">
          <div class="mb-4">
            <label for="country" class="block text-gray-700 text-sm font-bold mb-2">
              5 → País
            </label>
            <div class="relative">
              <select id="country" formControlName="country" name="country" autocomplete="off" class="block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 pr-8 rounded shadow leading-tight focus:outline-none focus:shadow-outline">
                <option value="">Seleccione un país</option>
                <option *ngFor="let pais of paises" [value]="pais">{{ pais }}</option>
              </select>
              <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                  <path d="M7 10l5 5 5-5H7z" />
                </svg>
              </div>
              <div *ngIf="country?.invalid && (country?.dirty || country?.touched)" class="text-red-500 text-sm mt-2">
                <div *ngIf="country?.errors?.['required']">
                  Debes seleccionar un País.
                </div>
              </div>
            </div>
          </div>
        </ng-container>

        <!-- Question 5: Address (only if country is Peru) -->
        <ng-container *ngIf="currentQuestion === 5">
          <div *ngIf="country?.value === 'Perú'" class="mb-4">
            <label for="address" class="block text-gray-700 text-sm font-bold mb-2">
              6 → Dirección
            </label>
            <input id="address" formControlName="address" name="address" type="text" placeholder="Your address" autocomplete="address"
                   class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
            <div *ngIf="address?.invalid && (address?.dirty || address?.touched)" class="text-red-500 text-sm mt-2">
              <div *ngIf="address?.errors?.['required']">
                Dirección es requerido.
              </div>
              <div *ngIf="address?.errors?.['pattern']">
                Solo permite letras A-Z.
              </div>
            </div>
          </div>
        </ng-container>

        <!-- Buttons -->
        <div class="flex items-center justify-between">
          <button *ngIf="currentQuestion < 5" class="bg-lime-green hover:bg-lime-green-dark text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline mt-4" type="submit">
            CONTINUAR
          </button>
          <button *ngIf="currentQuestion === 5" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline mt-4" type="button" (click)="onCancel()">
            CANCELAR
          </button>
          <button *ngIf="currentQuestion === 5" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline mt-4" type="button" (click)="onSave()">
            GUARDAR
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
